<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
    <title>Profile</title>
</head>
<body>

    <nav class="navbar navbar-expand-lg bg-forest border-bottom border-body">
        <div class="container">
          <a class="navbar-brand" href="{{ url_for('index') }}">
            <img src="{{ url_for('static', filename='logo.png') }}" alt="Logo" width="25" height="24" class="d-inline-block align-text-top">
            RoomSync</a>

        <div class="navbar-nav d-flex flex-row gap-3">
          <!-- Trigger Modal -->
            <a class="nav-link" href="#" data-bs-toggle="modal" data-bs-target="#editProfileModal">Edit Profile</a>
          <a class="nav-link" href="{{ url_for('matches') }}">View Matches</a>
          <a class="nav-link" href="{{ url_for('logout') }}">Log Out</a>
        </div>

        </div>
    </nav>


    <p>{{ profile.username }}</p>

    <p>{{ profile.email }}</p>

    <p>{{ profile.location }}</p>

    <p>{{ profile.budget }}</p>

    <p>{{ profile.lifestyle }}</p>


    <!-- Edit Profile Modal -->
    <div class="modal fade" id="editProfileModal" tabindex="-1" aria-labelledby="editProfileModalLabel" aria-hidden="true">
      <div class="modal-dialog">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title" id="editProfileModalLabel">Edit Profile</h5>
            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
          </div>
          <div class="modal-body">
            <form id="editProfileForm" method="POST" action="{{ url_for('profile') }}">
              <div class="mb-3">
                <label for="location" class="form-label">Location</label>
                <input type="text" class="form-control" id="location" name="location"
                       value="{{ profile.location or '' }}">
              </div>
              <div class="mb-3">
                <label for="budget" class="form-label">Budget</label>
                <input type="text" class="form-control" id="budget" name="budget"
                       value="{{ profile.budget or '' }}">
              </div>
              <div class="mb-3">
                <label for="lifestyle" class="form-label">Lifestyle</label>
                <input type="text" class="form-control" id="lifestyle" name="lifestyle"
                       value="{{ profile.lifestyle or '' }}">
              </div>
              <button type="submit" class="btn btn-dark w-100">Save Changes</button>
            </form>
          </div>
        </div>
      </div>
    </div>

  <!-- JavaScript -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>

</body>
</html>

<!-- 
19OCT Note from backend (delete when finished):

Data sources and available variables

  From database.py (backend data layer):
    - get_profile_by_user_id(user_id)      -> returns one user’s profile only
    - get_user_and_profile(user_id)        -> returns user + profile fields (used here)
    - get_profiles_except(user_id)         -> returns list of all other users’ profiles

  From matching.py (algorithm layer):
    - compatibility_score(me, other)
    - rank_candidates(me, candidates)


Template context for this page (/profile):

  You receive a single variable named "profile" (a dict) containing:
    - profile.username
    - profile.email
    - profile.budget
    - profile.location
    - profile.lifestyle
    (any of these may be empty strings if not yet set)

You can use these in HTML like:
  <p>{{ profile.username }}</p>
  <p>{{ profile.location or "Not specified" }}</p>

When the user submits edits:
  Form fields should POST with names:
    budget, location, lifestyle

Backend route automatically updates or inserts this profile info
-->